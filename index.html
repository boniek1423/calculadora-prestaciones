<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora LOTTT - Forum</title>
    <style>
        :root { --primary: #004a99; --accent: #d32f2f; }
        body { font-family: 'Segoe UI', sans-serif; background-color: #f0f2f5; padding: 20px; }
        .card { max-width: 550px; margin: auto; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        h2 { color: var(--primary); text-align: center; margin-bottom: 5px; }
        .field { margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 0.9em; color: #555; }
        input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 1em; }
        button { width: 100%; background: var(--primary); color: white; border: none; padding: 15px; border-radius: 8px; cursor: pointer; font-size: 1.1em; font-weight: bold; transition: 0.3s; }
        button:hover { background: #003366; }
        .result-box { margin-top: 20px; padding: 20px; border-radius: 10px; display: none; }
        .retroactivo { background: #fff3e0; border: 1px solid #ffb74d; }
        .garantia { background: #e8f5e9; border: 1px solid #81c784; margin-bottom: 10px; }
        .total-final { background: #e3f2fd; border: 2px solid var(--primary); font-size: 1.2em; text-align: center; }
        .whatsapp-btn { background: #25d366; margin-top: 10px; display: block; text-align: center; color: white; text-decoration: none; padding: 12px; border-radius: 8px; font-weight: bold; }
    </style>
</head>
<body>

<div class="card">
    <h2>Calculadora Laboral Ven</h2>
    <p style="text-align: center; color: #666; font-size: 0.9em; margin-bottom: 20px;">Ajustada al Art. 142 LOTTT</p>

    <div class="field">
        <label>Fecha de Ingreso:</label>
        <input type="date" id="f_ingreso" value="2023-09-06">
    </div>

    <div class="field">
        <label>Fecha de Egreso (o hoy):</label>
        <input type="date" id="f_egreso" value="2026-01-30">
    </div>

    <div class="field">
        <label>Sueldo Base Mensual (Bs.):</label>
        <input type="number" id="sueldo_bs" value="291.91">
    </div>

    <div class="field">
        <label>Bono Mensual / Complemento (USD):</label>
        <input type="number" id="bono_usd" value="150">
    </div>

    <button onclick="procesarCalculo()">CALCULAR LIQUIDACI칍N</button>

    <div id="res_garantia" class="result-box garantia"></div>
    <div id="res_retroactivo" class="result-box retroactivo"></div>
    
    <div id="res_total" class="result-box total-final">
        <strong>MONTO A FAVOR DEL TRABAJADOR</strong>
        <h3 id="monto_final"></h3>
        <small id="explicacion_ley"></small>
    </div>

    <a id="btn_ws" class="whatsapp-btn" style="display:none;" target="_blank">Compartir por WhatsApp 游님</a>
</div>

<script>
function procesarCalculo() {
    const fin = new Date(document.getElementById('f_ingreso').value);
    const feg = new Date(document.getElementById('f_egreso').value);
    const s_bs = parseFloat(document.getElementById('sueldo_bs').value) || 0;
    const b_usd = parseFloat(document.getElementById('bono_usd').value) || 0;

    // 1. Salario Normal Mensual (Convertimos Bs a USD para facilitar dado que Forum paga bonos en USD)
    // Usamos tasa referencial de 55 para el ejemplo (ajustable)
    const tasa = 55; 
    const sueldoNormalMensual = b_usd + (s_bs / tasa);
    const sueldoNormalDiario = sueldoNormalMensual / 30;

    // 2. C치lculo de Salario Integral (Art. 122)
    // Al칤cuota Utilidades (30 d칤as/360) + Al칤cuota Bono Vac (15 d칤as/360)
    const ali_util = 30 / 360;
    const ali_bvac = 15 / 360;
    const salarioIntegralDiario = sueldoNormalDiario + (sueldoNormalDiario * ali_util) + (sueldoNormalDiario * ali_bvac);

    // 3. Tiempo de servicio
    let diff = feg - fin;
    let mesesTotal = Math.floor(diff / (1000 * 60 * 60 * 24 * 30.44));
    let a침osTotal = mesesTotal / 12;

    // 4. GARANT칈A (Art. 142 lit. a y b) - 15 d칤as por trimestre
    let trimestres = Math.floor(mesesTotal / 3);
    let montoGarantia = trimestres * 15 * salarioIntegralDiario;

    // 5. RETROACTIVO (Art. 142 lit. c) - 30 d칤as por a침o o fracci칩n > 6 meses
    let diasRetroactivo = 0;
    let a침osRedondeados = Math.floor(a침osTotal);
    let fraccionMeses = mesesTotal % 12;
    
    if (fraccionMeses >= 6) {
        diasRetroactivo = (a침osRedondeados + 1) * 30;
    } else {
        diasRetroactivo = a침osRedondeados * 30;
    }
    const montoRetroactivo = diasRetroactivo * salarioIntegralDiario;

    // 6. Determinar cu치l es mayor (Art. 142 lit. d)
    const final = Math.max(montoGarantia, montoRetroactivo);

    // Mostrar Resultados
    document.getElementById('res_garantia').style.display = 'block';
    document.getElementById('res_garantia').innerHTML = `Garant칤a Trimestral: $${montoGarantia.toFixed(2)}`;
    
    document.getElementById('res_retroactivo').style.display = 'block';
    document.getElementById('res_retroactivo').innerHTML = `Retroactivo (30 d칤as/a침o): $${montoRetroactivo.toFixed(2)}`;

    document.getElementById('res_total').style.display = 'block';
    document.getElementById('monto_final').innerText = `$${final.toFixed(2)}`;
    document.getElementById('explicacion_ley').innerText = (montoRetroactivo > montoGarantia) 
        ? "Se aplica el Retroactivo por ser m치s favorable." 
        : "Se aplica la Garant칤a acumulada.";

    // Bot칩n WhatsApp
    const msg = encodeURIComponent(`Mi c치lculo estimado en Forum es: $${final.toFixed(2)}. Calculado con la App LOTTT.`);
    document.getElementById('btn_ws').style.display = 'block';
    document.getElementById('btn_ws').href = `https://wa.me/?text=${msg}`;
}
</script>

</body>
</html>
